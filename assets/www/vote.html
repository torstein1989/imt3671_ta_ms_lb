<!DOCTYPE HTML>
<html>
<head>
<title>PhoneGap</title>
<script type="text/javascript" charset="utf-8" src="js/phonegap-1.1.0.js"></script>
<script type="text/javascript" charset="utf-8" src="js/jquery-1.6.4.js"></script>
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0rc2/jquery.mobile-1.0rc2.min.css" />
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script src="http://code.jquery.com/mobile/1.0rc2/jquery.mobile-1.0rc2.min.js"></script>
<script>
	var vote = -1;
	var vID = -1;	
	/**
		Get the voteID from the called function 
	*/
	
	$(document).ready(function(){
		/**
		$("input").live("change",function(e){
			  alert( "Change event! new value is " + $(this).val() );
			  $("input[type=radio]").attr("checked",true).checkboxradio("refresh");
			});*/
		
		getVoteId();//get the current QuestionID
		
		$("#subBtn").click(function(){
			vote = $("input[name=vote]:checked").val();
			if(vote == undefined){
				alert("Please choose a selection!");
			}
			else{
				getVoteId();//get the current QuestionID
				postData();
				alert("Answer OK and ID: "+vID)
				$("input[type='radio']").attr("checked",false).checkboxradio("refresh");//Resets the radiobutton
			}
			
		});//click function end
		
				
		function postData(){
			$.ajax({
				url: "http://www.stud.hig.no/~090917/teacherfeed/vote.php",
				type: "POST",
				data: 	"&vID="+vID+
						"&vote="+vote,
				success:function(data){
				}
			});//ajax-end
		}//postdata-End
		
		function getVoteId(){
			$.ajax({
				url: 'http://www.stud.hig.no/~090917/teacherfeed/getQuestion.php',
				type: 'GET',
				dataType: 'json',
				success: function(data) {
					var idData = parseInt(data[0]);
					vID = idData;
				}
			});//ajax-end
		}//getVoteId-End
	});
</script>
</head>
<body>
<div data-role="page">
	<div data-role="fieldcontain">	
		<fieldset data-role="controlgroup" data-type="horizontal">
		<legend>Choose a answer:</legend>
			<input type="radio" id="vote1" name="vote" value="1" /> 
			<label for="vote1">A</label>
			<input type="radio" id="vote2" name="vote" value="2" />
			<label for="vote2">B</label>
			<input type="radio" id="vote3" name="vote" value="3" /> 
			<label for="vote3">C</label>
			<input type="radio" id="vote4" name="vote" value="4" /> 
			<label for="vote4">D</label>
			
			<button type="button" id="subBtn"> VOTE THIS</button>
		</fieldset>
	</div>
</div>
</body>
</html>